# 后台系统项目

## 人资中台

### 项目描述

> iHRM 是一款基于 SaaS 平台的人力资源管理系统， 企业通过该系统可以完成公司组织架构管理、员工管理、角色管理、权限管理（审批、考勤、社保）等，为企业的人力资源管理提供一站式解决方案。

### 技术栈

vue admin template 基础架构（方案） =》vue 全家桶+element 组件库+自带功能组件（Excel 导入导出等）

### 项目职责

#### 环境变量配置

- 项目职责描述：基于 vue admin template 基础架构搭建项目，设计基础目录结构和配置业务需要的环境变量

> vue-cli 怎么设置环境变量？ 什么是模式？

答：

vue-cli 创建的项目默认有三个模式

1. development 模式用于 vue-cli-service serve（执行这个命令）=>`npm run dev/serve`
2. test 模式用于 vue-cli-service test:unit
3. production 模式用于 vue-cli-service build=> `npm run build`

说明：比较常用的是 development 和 production 模式，对应开发和生产环境

环境变量设置

1. 通过.env.[mode]文件设置（以开发环境为例）
   a. 设置开发环境环境变量，在项目根目录新建.env.development 文件
   b. 在.env.development 文件中：key=value
   c. 说明：VUE*APP*开头的变量可以通过 process.env 在项目中获取使用
2. 设置完，需要重启服务

#### 登录

- 项目职责描述：基于 JWT 架构实现登录，借助 vuex 和本地存储实现登录鉴权数据的持久化

#### 组织架构

- 项目职责描述：使用树形组件铺设组织架构数据，实现部门的新增、编辑、删除操作；同时抽离封装了树形数据转换方法，方便项目后期维护和复用

> 什么是树形数据结构和转换方式？

答：

- 转换结果：[{name:'',children:[]}]=>树形结构

根据现有数据找规律：

    1. 公司pid的值是：-1

    2. 公司下的顶级部门pid的值是：''(空字符串)

    3. **公司下的子孙部门的pid的值是：父部门的id值**

核心：找父部门

思路步骤：

    1. 新建转换的树形数据：[]

    2. 构建映射关系：map

    3. 根据map映射关系遍历list对比

    4. 返回转换完的树形结构

#### 员工管理

- 项目职责描述：实现对员工的 CURD 功能，做了部门选择组件的封装复用；考虑业务需要，实现员工的批量导入和导出功能

> 讲讲 excel 导入和导出的实现？

答：

1. 公司的导入导出因为数据量并不大，所以采用的主要方式的前端主导的导入方案，主要是借助插件，通过插件把 excel 表格转化成 js 的数据类型，然后按照后端接口的要求调用接口完成导入，这里主要的问题还是数据处理，插件处理之后的数据和后端接口要求的数据并不一致

2. 导出的话主要是调用的后端接口，告诉后端需要导出的数据，然后利用插件把后端接口返回的数据转化成插件要求的格式，然后触发浏览器的下载功能进行下载

#### 员工详情

- 项目职责描述：实现员工详情数据铺设，借助三方云服务存储用户头像、文件等

> 员工头像数据上云实现

答：核心是使用三方云服务，把**图片或文件存储到云服务器**，云服务器的存储 url 存储到公司自由服务器

#### 权限管理和角色管理

> 实现权限控制，配套的两个页面开发

- 项目职责描述：使用列表和分页组件，实现角色和权限模块的 CURD 功能

#### 权限设计和实现

- 项目职责描述：设计实现动静路由结合前置守卫，根据登录人权限标识 flag，对页面和页面下的功能做权限控制；解决动态路由刷新 404 和缓存问题

> 后台系统如何进行权限控制和实现？

答：

1. 基于 RBAC 设计权限管理，对路由进行**动**、静划分 =》RBAC 核心：**把权限点分配给角色**=》**角色** =》分配给员工
2. 根据登录人 menus 中权限标识 code ，**使用路由实例的 addRoutes 方法动态添加**对应 code 代表的路由页面到路由堆栈，就能访问对应页面
3. 根据登录人 points 中权限标识 code ，**使用 mixin 混入全局检测方法**，检测当前登录人是否具有某个按钮的使用权限

```js
// 白名单（不需要token也能访问的页面）
const whiteList = ['/login', '/404']
/**
 * to 去哪
 * from 从哪来
 * next（函数）是否放行（访问页面）
 */
router.beforeEach(async (to, from, next) => {
  // start progress bar开启进度条
  NProgress.start()
  if (store.getters.token) {
    // 1. 有token
    if (to.path === '/login') {
      // 如果是登录页跳到首页
      next('/')
    } else {
      next()
      // 在这里获取登录人信息
      if (!store.getters.name) {
        const roles = await store.dispatch('user/getUserInfoAction')
        console.log('权限数据：', roles)
        /**
         * 权限控制=》页面访问权限
         * 思路步骤：
         * 1. 获取当前登录人可以访问页面的身份标识
         * 2. 根据这个身份标识(menus)和asyncRoutes（动态路由）对比=》留下有身份标识的页面路由规则
         * 3. 把上一步留下有身份标识的页面路由规则=》动态追加到路由规则routes数组中
         */
        const canLook = asyncRoutes.filter((route) => {
          // 根据这个身份标识(menus)和route子路由默认首页name对比=》存在就留下
          // 注意：route.children[0].name 和 权限点的code 要一致
          return roles.menus.includes(route.children[0].name)
        })
        console.log('获取当前登录人可以看的页面：', canLook)
        // 存储菜单数据
        store.commit('routes/setMenuList', canLook)
        // 把动态路由添加到应用的路由系统里=> 动态追加到静态路由后边
        router.addRoutes([
          ...canLook,
          { path: '*', redirect: '/404', hidden: true },
        ])
      }
    }
  } else {
    // 2. 没有token
    if (whiteList.includes(to.path)) {
      next()
    } else {
      next('/login')
    }
  }

  // finish progress bar关闭进度条
  NProgress.done()
})
```

> 扩展：权限控制中运到的难题或坑？

1. 动态添加的路由，刷新后 404=》把 404 页面路由放到最后
2. 路由缓存=》退出登录，重置路由

#### 首页开发

- 项目职责描述：实现系统的国际化，准备中英语言包，支持动态一键切换语言

> 讲讲国际化实现思路？

答：国际化的实现思路主要是通过 **i18n 国际化插件**实现的

1. 首先需要**提前准备好国际化需要的语言包**，也就是语言之间的对应关系
2. 在项目里安装了 i18n 国际化包，在 Vue 原型上挂载了转化方法=>`$t(传入翻译的对象路径)`
3. 在组件中需要做国际化的地方 通过转化方法对对应的文字进行方法调用转化为特定的语言显示

> 扩展：语言动态切换的坑？

答：部分组件，语言切换后，不刷新问题

#### 打包优化

- 项目职责描述：项目上线前，对系统进行打包优化配置，按需加载和大文件 cdn 优化，提升线上环境运行性能

> 讲讲项目打包优化方案有哪些？

1. 路由懒加载，代码分割=》按需加载=》例如：访问 A 页面，才会加载 A 页面的代码并执行
2. 排除大文件，使用 cdn 加载资源 => `npm run preview -- --report`

## 人资中台-打样

### 项目介绍

一款基于 SaaS 平台的人力资源管理系统， 企业通过该系统可以完成公司组织架构管理、员工管理、角色管理、权限管理（审批、考勤、社保）等，为企业的人力资源管理提供一站式解决方案。

### 技术栈

vue admin template + vue 全家桶 + axios + elementUI

### 项目职责

1. 基于 vue admin template 基础架构搭建项目，设计基础目录结构和配置业务需要的环境变量
2. 基于 JWT 架构实现登录，借助 vuex 和本地存储实现登录鉴权数据的持久化
3. 使用树形组件铺设组织架构数据，实现部门的新增、编辑、删除操作；同时抽离封装了树形数据转换方法，方便项目后期维护和复用
4. 实现对员工的 CURD 功能，做了部门选择组件的封装复用；考虑业务需要，实现员工的批量导入和导出功能
5. 实现员工详情数据铺设，借助三方云服务存储用户头像、文件等
6. 设计实现动静路由结合前置守卫，根据登录人权限标识 flag，对页面和页面下的功能做权限控制；解决动态路由刷新 404 和缓存问题
7. 实现系统的国际化，准备中英语言包，支持动态一键切换语言
8. 项目上线前，对系统进行打包优化配置，按需加载和大文件 cdn 优化，提升线上环境运行性能

## 头条后台-打样

找项目-大宝库：https://github.com/ https://gitee.com/ =》例如：vue2 后台管理系统、vue2 餐饮管理系统等等

演示：http://heima-project.gitee.io/geek-pc

### 项目描述

> 自媒体后台管系统系，自媒体从业者可以注册登录、管理文章、文章分类、文章数据分析、文章搜索、评论管理、粉丝管理、个人信息维护等一站式服务体验

### 技术栈

vue 全家桶 + elementUI 组件库 + axios + echarts

### 项目职责

1. 自媒体用户的注册和登录，使用 veux 维护登录用户信息并持久化
2. 后台首页对自媒体文章进行数据分析和展现，帮助用户了解文章阅读量、评论数、访问量等信息
3. 实现对文章分类的管理和维护功能
4. 实现对文章的搜索、过滤、发表，编辑
5. 实现对自媒体用户粉丝的管理和分析
6. 支持自媒体用户个人信息的修改和维护

后台系统包装-搜索后台系统产品：https://www.soft78.com/
